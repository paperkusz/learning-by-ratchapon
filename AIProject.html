<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>สุ่มหัวข้อโครงงาน (จำกัด 5 ครั้ง)</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        
        .container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            padding: 30px;
            width: 90%;
            max-width: 700px;
            text-align: center;
            margin: 20px;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .description {
            color: #7f8c8d;
            margin-bottom: 25px;
        }
        
        .counter {
            background-color: #3498db;
            color: white;
            border-radius: 50px;
            padding: 8px 18px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 20px;
        }
        
        .topic-display {
            background-color: #f8f9fa;
            border-left: 5px solid #3498db;
            padding: 25px;
            margin: 30px 0;
            border-radius: 8px;
            font-size: 1.4rem;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            line-height: 1.5;
        }
        
        .topic-display.highlight {
            background-color: #e8f4fc;
            border-left-color: #2980b9;
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .random-button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 15px 35px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
            margin: 10px;
        }
        
        .random-button:hover {
            background-color: #2980b9;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(52, 152, 219, 0.4);
        }
        
        .random-button:active {
            transform: translateY(0);
        }
        
        .random-button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .footer {
            margin-top: 30px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .attempts-info {
            color: #e74c3c;
            font-weight: bold;
            margin-top: 15px;
        }
        
        .ip-info {
            font-size: 0.8rem;
            color: #95a5a6;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>สุ่มหัวข้อโครงงาน</h1>
        <p class="description">กดปุ่มด้านล่างเพื่อสุ่มหัวข้อโครงงานจากรายการ 100 หัวข้อ</p>
        
        <div class="counter">เหลือการสุ่ม: <span id="remainingAttempts">5</span> ครั้ง</div>
        
        <div class="topic-display" id="topicDisplay">
            กดปุ่ม "สุ่มหัวข้อ" เพื่อเริ่มต้น
        </div>
        
        <button class="random-button" id="randomButton">สุ่มหัวข้อ</button>
        
        <div class="attempts-info" id="attemptsInfo"></div>
        
        <div class="footer">
            มีหัวข้อให้สุ่มทั้งหมด <span id="topicCount">100</span> หัวข้อ
        </div>
        
        <div class="ip-info">ระบบจดจำไอพี: <span id="ipAddress"></span></div>
    </div>

    <script>
        // รายการหัวข้อโครงงาน 100 หัวข้อ
        const topics = [
            "AI วิเคราะห์พฤติกรรมการเรียนของนักเรียน",
            "ตรวจจับคุณภาพน้ำในแม่น้ำหรือบ่อปลา",
            "ตรวจจับฝุ่น PM2.5 แบบเรียลไทม์",
            "ตรวจจับโรคหรือปัญหาสุขภาพของพืช",
            "ระบบนับคนเข้า-ออกอาคารด้วยกล้อง AI",
            "ตรวจจับความหนาแน่นการจราจร",
            "แนะนำการออกกำลังกายตามสภาพร่างกาย",
            "ตรวจจับพฤติกรรมเสี่ยงบนถนน",
            "ระบบจำแนกประเภทขยะอัตโนมัติ",
            "วิเคราะห์ความเครียดจากเสียงหรือข้อความ",
            "ระบบช่วยจำวันนัดหรือกิจกรรมประจำวัน",
            "ตรวจจับโรคหรือสุขภาพสัตว์เลี้ยง",
            "ตรวจจับสิ่งกีดขวางหรืออุบัติเหตุบนถนน",
            "วิเคราะห์แนวโน้มราคาผลผลิตเกษตร",
            "ตรวจจับความร้อนหรือไฟไหม้ในบ้าน/ป่า",
            "แนะนำหนังสือหรือเนื้อหาการเรียน",
            "ตรวจจับหน้ากากอนามัยหรืออุปกรณ์ป้องกัน",
            "ตรวจจับความผิดปกติของเครื่องจักร",
            "ช่วยเตือนภัยน้ำท่วมหรือฝนตกหนัก",
            "แนะนำเส้นทางเดินรถจักรยานหรือคนเดิน",
            "แนะนำเสื้อผ้าและแฟชั่นตามฤดูกาล",
            "วิเคราะห์ภาพดาวเทียมเพื่อประเมินพื้นที่เกษตร",
            "ตรวจจับการทำงานผิดปกติในโรงงาน",
            "ตรวจจับพฤติกรรมผิดปกติของนักเรียน",
            "ระบบช่วยจัดตารางเรียนหรือทำงานอัตโนมัติ",
            "ตรวจจับเสียงสัตว์หรือสิ่งแวดล้อมเพื่อวิจัย",
            "จำแนกวัตถุหรือผลิตภัณฑ์ในร้านค้า",
            "วิเคราะห์ความคิดเห็นหรือรีวิวของลูกค้า",
            "ตรวจจับการรั่วไหลของน้ำหรือแก๊ส",
            "ตรวจจับการเคลื่อนไหวผิดปกติในบ้านผู้สูงอายุ",
            "ตรวจสอบคุณภาพอาหารด้วยภาพ",
            "วิเคราะห์ความนิยมของเพลงหรือสื่อบันเทิง",
            "ตรวจจับอุปกรณ์หรือเครื่องมือหาย/ขโมย",
            "จำแนกวัสดุก่อสร้างหรืออุปกรณ์อุตสาหกรรม",
            "ตรวจจับการขับขี่ผิดปกติ เช่น โทรศัพท์ขณะขับรถ",
            "วิเคราะห์น้ำหนักตัวหรือสุขภาพผู้ใช้",
            "ตรวจจับปริมาณน้ำฝนและการระบายน้ำ",
            "วิเคราะห์ภาพทางการแพทย์เบื้องต้น",
            "แนะนำการใช้พลังงานไฟฟ้าอย่างประหยัด",
            "AI ช่วยสร้างเกมหรือสื่อการเรียนรู้โต้ตอบ",
            "ระบบตรวจจับพฤติกรรมผู้ใช้ในห้องสมุด",
            "วิเคราะห์ปริมาณอาหารเสียในร้านอาหาร",
            "ระบบช่วยให้ผู้พิการใช้งานอุปกรณ์อัจฉริยะ",
            "ตรวจจับเสียงเตือนอันตรายในโรงงาน",
            "AI ช่วยวิเคราะห์ความชื้นและอุณหภูมิในฟาร์ม",
            "ระบบติดตามการใช้วัสดุในโรงเรียน",
            "ตรวจจับพฤติกรรมผู้ป่วยในโรงพยาบาล",
            "วิเคราะห์แนวโน้มราคาหุ้นสำหรับนักลงทุนมือใหม่",
            "AI ตรวจจับและแจ้งเตือนไฟไหม้ป่า",
            "ระบบติดตามการบริโภคน้ำของครัวเรือน",
            "ตรวจจับอุบัติเหตุในสนามกีฬา",
            "AI ช่วยวิเคราะห์ความถี่การใช้แอปพลิเคชัน",
            "ระบบตรวจจับและจำแนกประเภทของยานพาหนะ",
            "วิเคราะห์พฤติกรรมการใช้พลังงานในโรงเรียน",
            "AI ตรวจจับโรคผิวหนังเบื้องต้น",
            "ระบบแจ้งเตือนการจอดรถผิดกฎหมาย",
            "วิเคราะห์ภาพถ่ายเพื่อคาดการณ์ภัยแล้ง",
            "AI ช่วยจำแนกพืชสมุนไพรและสรรพคุณ",
            "ระบบตรวจจับเสียงร้องของสัตว์ในสวนสัตว์",
            "AI วิเคราะห์รูปแบบการอ่านหนังสือของนักเรียน",
            "ระบบตรวจจับและแจ้งเตือนท่อแตกในอาคาร",
            "AI แนะนำกิจกรรมนันทนาการสำหรับผู้สูงอายุ",
            "ระบบตรวจสอบความสะอาดของห้องน้ำ",
            "AI วิเคราะห์ข้อมูลการเดินทางของนักท่องเที่ยว",
            "ระบบตรวจจับและแจ้งเตือนมลพิษเสียง",
            "AI ตรวจจับอาการเหนื่อยล้าของคนขับรถ",
            "ระบบช่วยวิเคราะห์ความเสี่ยงภัยธรรมชาติในพื้นที่",
            "AI วิเคราะห์ข้อมูลการบริโภคอาหารเพื่อสุขภาพ",
            "ระบบช่วยตรวจสอบความสมบูรณ์ของผลผลิตการเกษตร",
            "AI ตรวจจับอารมณ์จากใบหน้าผู้เรียน",
            "ระบบช่วยจัดการสมุดบันทึกออนไลน์ของนักเรียน",
            "AI ช่วยประเมินคุณภาพงานฝีมือหรือศิลปะ",
            "ระบบตรวจจับการสูบบุหรี่ในพื้นที่สาธารณะ",
            "AI วิเคราะห์ข้อมูลจากเซนเซอร์วัดน้ำในตู้ปลา",
            "ระบบช่วยวิเคราะห์และแนะนำการทำสวนในเมือง",
            "AI ตรวจจับการรั่วไหลของสารเคมีในโรงงาน",
            "ระบบตรวจจับความผิดปกติของอาคารเก่า",
            "AI ช่วยคาดการณ์ความต้องการน้ำของพืช",
            "ระบบช่วยจัดการเวลาการทำงานหรือการบ้านของนักเรียน",
            "AI วิเคราะห์เสียงร้องของเด็กเพื่อประเมินอารมณ์",
            "ระบบตรวจจับการจราจรบนทางเท้า",
            "AI ช่วยแนะนำการเดินทางแบบประหยัดพลังงาน",
            "ระบบตรวจจับสัตว์เลี้ยงหาย",
            "AI วิเคราะห์ผลการแข่งขันกีฬาเพื่อปรับแผนฝึกซ้อม",
            "ระบบตรวจจับพฤติกรรมเสี่ยงบนโซเชียลมีเดีย",
            "AI ช่วยตรวจสอบการปลูกพืชในระบบ Hydroponics",
            "ระบบวิเคราะห์ข้อมูลสภาพอากาศเพื่อการเกษตร",
            "AI ช่วยจำแนกของเหลือใช้หรือรีไซเคิล",
            "ระบบตรวจจับความผิดปกติของสายส่งไฟฟ้า",
            "AI ช่วยวิเคราะห์แนวโน้มแฟชั่นในโซเชียลมีเดีย",
            "ระบบตรวจจับการละเมิดลิขสิทธิ์ภาพ/วีดีโอ",
            "AI วิเคราะห์ภาพจากกล้องวงจรปิดเพื่อตรวจสอบความปลอดภัย",
            "ระบบช่วยติดตามและแจ้งเตือนปริมาณน้ำมันเชื้อเพลิง",
            "AI ช่วยประเมินระดับน้ำและคุณภาพน้ำในคลอง",
            "ระบบตรวจจับเสียงผิดปกติในเครื่องจักร",
            "AI ช่วยวิเคราะห์โครงสร้างอาคารเพื่อความปลอดภัย",
            "ระบบตรวจจับและวิเคราะห์สัญญาณการเตือนภัยในโรงเรียน",
            "AI ช่วยจำแนกสัตว์ป่าและติดตามจำนวนประชากร",
            "ระบบวิเคราะห์ข้อมูลการเข้าถึงเว็บไซต์หรือแอปพลิเคชัน"
        ];

        // อ้างอิงถึง DOM elements
        const topicDisplay = document.getElementById('topicDisplay');
        const randomButton = document.getElementById('randomButton');
        const remainingAttemptsElement = document.getElementById('remainingAttempts');
        const attemptsInfoElement = document.getElementById('attemptsInfo');
        const ipAddressElement = document.getElementById('ipAddress');

        // ตัวแปรสำหรับเก็บข้อมูล
        let remainingAttempts = 5;
        let usedTopics = [];
        let userIP = '';

        // ฟังก์ชันสุ่มหัวข้อ
        function getRandomTopic() {
            const availableTopics = topics.filter(topic => !usedTopics.includes(topic));
            if (availableTopics.length === 0) return "ไม่มีหัวข้อเหลือให้สุ่มแล้ว";
            
            const randomIndex = Math.floor(Math.random() * availableTopics.length);
            return availableTopics[randomIndex];
        }

        // ฟังก์ชันดึง IP Address
        async function getIPAddress() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (error) {
                // หากไม่สามารถดึง IP จริงได้ ให้ใช้ IP แบบสุ่มเป็น fallback
                return 'user-' + Math.floor(Math.random() * 1000000);
            }
        }

        // ฟังก์ชันโหลดข้อมูลจากเซิร์ฟเวอร์
        async function loadUserData() {
            userIP = await getIPAddress();
            ipAddressElement.textContent = userIP;
            
            try {
                // ในทางปฏิบัติควรส่ง request ไปยังเซิร์ฟเวอร์เพื่อตรวจสอบข้อมูล
                // แต่สำหรับตัวอย่างนี้ เราจะใช้ localStorage แทน
                const savedData = localStorage.getItem(`projectTopic_${userIP}`);
                
                if (savedData) {
                    const data = JSON.parse(savedData);
                    remainingAttempts = data.remainingAttempts;
                    usedTopics = data.usedTopics || [];
                    
                    // อัพเดทการแสดงผล
                    remainingAttemptsElement.textContent = remainingAttempts;
                    
                    if (remainingAttempts <= 0) {
                        randomButton.style.display = 'none';
                        attemptsInfoElement.textContent = "คุณใช้การสุ่มครบ 5 ครั้งแล้ว";
                        
                        // แสดงหัวข้อล่าสุด
                        if (usedTopics.length > 0) {
                            topicDisplay.textContent = usedTopics[usedTopics.length - 1];
                        }
                    } else if (usedTopics.length > 0) {
                        // แสดงหัวข้อล่าสุด
                        topicDisplay.textContent = usedTopics[usedTopics.length - 1];
                    }
                }
            } catch (error) {
                console.error("Error loading user data:", error);
            }
        }

        // ฟังก์ชันบันทึกข้อมูล
        function saveUserData() {
            try {
                const dataToSave = {
                    remainingAttempts: remainingAttempts,
                    usedTopics: usedTopics,
                    timestamp: new Date().getTime()
                };
                
                // ในทางปฏิบัติควรส่งข้อมูลไปบันทึกในเซิร์ฟเวอร์
                // แต่สำหรับตัวอย่างนี้ เราใช้ localStorage
                localStorage.setItem(`projectTopic_${userIP}`, JSON.stringify(dataToSave));
            } catch (error) {
                console.error("Error saving user data:", error);
            }
        }

        // ฟังก์ชันอัพเดทสถานะการสุ่ม
        function updateAttempts() {
            remainingAttempts--;
            remainingAttemptsElement.textContent = remainingAttempts;
            
            // บันทึกข้อมูล
            saveUserData();
            
            if (remainingAttempts <= 0) {
                randomButton.style.display = 'none';
                attemptsInfoElement.textContent = "คุณใช้การสุ่มครบ 5 ครั้งแล้ว";
            }
        }

        // การทำงานเมื่อกดปุ่มสุ่ม
        randomButton.addEventListener('click', function() {
            // สุ่มหัวข้อ
            const newTopic = getRandomTopic();
            
            // ตรวจสอบว่ายังมีหัวข้อเหลืออยู่
            if (newTopic === "ไม่มีหัวข้อเหลือให้สุ่มแล้ว") {
                topicDisplay.textContent = newTopic;
                return;
            }
            
            usedTopics.push(newTopic);
            
            // เพิ่มเอฟเฟกต์ไฮไลต์
            topicDisplay.classList.add('highlight');
            
            // เปลี่ยนหัวข้อ
            topicDisplay.textContent = newTopic;
            
            // อัพเดทจำนวนครั้งที่เหลือ
            updateAttempts();
            
            // ลบเอฟเฟกต์ไฮไลต์หลังจาก animation เสร็จ
            setTimeout(() => {
                topicDisplay.classList.remove('highlight');
            }, 300);
        });

        // โหลดข้อมูลเมื่อหน้าเว็บโหลดเสร็จ
        window.addEventListener('load', function() {
            loadUserData();
        });
    </script>
</body>
</html>